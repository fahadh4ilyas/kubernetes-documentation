<div id='write'  class=''>
    <h3><a name="2-membuat-cluster" class="md-header-anchor"></a><span>2. Membuat Cluster</span></h3>
    <p><span>Setelah setiap mesin sudah dipasang Docker dan tiga </span><em><span>packages</span></em><span> yang dibutuhkan, akan dijelaskan bagaimana cara membuat </span><em><span>cluster</span></em><span>. Terdapat dua macam bentuk </span><em><span>cluster</span></em><span> yang bisa dibuat:</span></p>
    <ol start='' ><li><em><span>Cluster</span></em><span> dengan satu </span><strong><em><span>master node</span></em></strong><span>.</span></li><li><em><span>Cluster</span></em><span> dengan lebih dari satu </span><em><span>master node</span></em><span>.</span></li></ol>
    <p><span>Perbedaan mendasar dari dua macam bentuk </span><em><span>cluster</span></em><span> di atas adalah dibutuhkannya </span><strong><em><span>load-balancer</span></em></strong><span> antar </span><em><span>master node</span></em><span> untuk </span><em><span>cluster</span></em><span> dengan lebih dari satu </span><em><span>master node</span></em><span> agar pengguna dapat dengan mudah berkomunikasi dengan </span><em><span>cluster</span></em><span> tanpa harus memikirkan </span><em><span>master node</span></em><span> mana yang sedang aktif. Ada banyak cara untuk membangun </span><em><span>load-balancer</span></em><span>, salah satunya dengan menggunakan </span><strong><span>keepalived</span></strong><span>.</span></p>
    <blockquote><p><span>disarankan untuk menggunakan </span><strong><em><span>root user</span></em></strong><span> untuk membuat </span><em><span>cluster</span></em></p></blockquote>
    <p><span>Pertama, pada mesin yang ingin dijadikan sebagai </span><em><span>master node</span></em><span>, jalankan perintah berikut</span></p>
    <pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kubeadm init <span class="cm-attribute">--control-plane-endpoint</span> <span class="cm-string">"&lt;control_plane_ip&gt;:&lt;control_plane_port&gt;"</span> <span class="cm-attribute">--pod-network-cidr</span> <span class="cm-string">"&lt;network_cidr&gt;"</span> <span class="cm-attribute">--upload-certs</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre>
    <figure><table><thead><tr><th><span>Parameter</span></th><th><span>Keterangan</span></th></tr></thead><tbody><tr><td><code>--pod-network-cidr</code></td><td><span>digunakan untuk menentukan </span><strong><em><span>class IP</span></em></strong><span> dari semua </span><strong><em><span>pod</span></em></strong><span> yang dibuat oleh </span><em><span>cluster</span></em><span> (misalnya 10.244.0.0/16). Parameter ini bergantung pada </span><strong><em><span>CNI plugin</span></em></strong><span> (misalnya </span><strong><span>flannel</span></strong><span>).</span></td></tr><tr><td><code>--control-plane-endpoint</code></td><td><span>digunakan untuk menentukan </span><strong><em><span>API Server</span></em></strong><span> dari Kubernetes. Untuk </span><em><span>cluster</span></em><span> yang memiliki satu </span><em><span>master node</span></em><span>, parameter ini bisa tidak dipakai karena secara </span><em><span>default</span></em><span> akan menggunakan </span><code>&quot;&lt;IP_MESIN&gt;:6443&quot;</code><span>.</span></td></tr><tr><td><code>--upload-certs</code></td><td><span>digunakan untuk mengeluarkan kode </span><strong><em><span>certificate-key</span></em></strong><span> yang akan digunakan untuk menambah </span><em><span>master node</span></em><span>. Gunakan ini jika ingin membuat </span><em><span>cluster</span></em><span> dengan lebih dari satu </span><em><span>master node</span></em><span>.</span></td></tr></tbody></table></figure>
    <p><span>Tunggu beberapa saat sampai inisiasi selesai dan keluar teks seperti berikut</span></p>
    <pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">You can now join any number of control-plane <span class="cm-builtin">node</span> by running the following command on each as a root:</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  kubeadm join <span class="cm-number">192</span>.168.0.200:6443 <span class="cm-attribute">--token</span> 9vr73a.a8uxyaju799qwdjv <span class="cm-attribute">--discovery-token-ca-cert-hash</span> sha256:7c2e69131a36ae2a042a339b33381c6d0d43887e2de83720eff5359e26aec866 <span class="cm-attribute">--control-plane</span> <span class="cm-attribute">--certificate-key</span> f8902e114ef118304e561c3ecd4d0b543adc226b7a07f675f56564185ffe0c07</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Please note that the certificate-key gives access to cluster sensitive data, keep it secret!</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">As a safeguard, uploaded-certs will be deleted <span class="cm-keyword">in</span> two hours; If necessary, you can use kubeadm init phase upload-certs to reload certs afterward.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Then you can join any number of worker nodes by running the following on each as root:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  kubeadm join <span class="cm-number">192</span>.168.0.200:6443 <span class="cm-attribute">--token</span> 9vr73a.a8uxyaju799qwdjv <span class="cm-attribute">--discovery-token-ca-cert-hash</span> sha256:7c2e69131a36ae2a042a339b33381c6d0d43887e2de83720eff5359e26aec866</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 276px;"></div><div class="CodeMirror-gutters" style="display: none; height: 276px;"></div></div></div></pre>
    <p><span>Untuk </span><em><span>cluster</span></em><span> dengan lebih dari satu </span><em><span>master node</span></em><span>, jika </span><em><span>cluster</span></em><span> hanya memiliki satu </span><em><span>master node</span></em><span>, yang keluar akan seperti berikut</span></p>
    <pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">you can join any number of worker nodes by running the following on each as root:</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  kubeadm join <span class="cm-number">192</span>.168.0.200:6443 <span class="cm-attribute">--token</span> 9vr73a.a8uxyaju799qwdjv <span class="cm-attribute">--discovery-token-ca-cert-hash</span> sha256:7c2e69131a36ae2a042a339b33381c6d0d43887e2de83720eff5359e26aec866</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre>
    <p><span>Salin teks tersebut terutama yang berawalan </span><code>kubeadm join</code><span> karena akan digunakan untuk menambahkan </span><em><span>master/worker node</span></em><span> ke dalam </span><em><span>cluster</span></em><span>.</span></p>
    <p><span>Sebelum menambahkan </span><em><span>node</span></em><span> lain, jalankan perintah berikut</span></p>
    <pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">mkdir</span> <span class="cm-attribute">-p</span> <span class="cm-def">$HOME</span>/.kube</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cp</span> <span class="cm-attribute">-i</span> /etc/kubernetes/admin.conf <span class="cm-def">$HOME</span>/.kube/config</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre>
    <blockquote><p><span>Perintah di atas digunakan agar pengguna dapat mengakses </span><em><span>cluster</span></em><span> menggunakan </span><em><span>package kubectl</span></em><span>.</span></p></blockquote>
    <p><span>Selanjutnya adalah meluncurkan </span><strong><em><span>Pod Network</span></em></strong><span> agar dapat terjalin komunikasi antar </span><em><span>node</span></em><span>. Jalankan perintah berikut</span></p>
    <pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kubectl apply <span class="cm-attribute">-f</span> https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre>
    <blockquote><p><em><span>Pod Network</span></em><span> yang digunakan disarankan adalah </span><em><span>flannel</span></em><span> seperti pada perintah di atas.</span></p></blockquote>
    <p><span>Untuk memeriksa apakah </span><em><span>pod network</span></em><span> sudah diluncurkan dengan perintah</span></p>
    <pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">watch <span class="cm-attribute">-n</span> <span class="cm-number">1</span> kubectl <span class="cm-builtin">get</span> pods <span class="cm-attribute">--all-namespaces</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre>
    <p><span>Jika semua </span><strong><span>STATUS</span></strong><span> sudah </span><strong><span>Running</span></strong><span>, maka sudah dapat menambahkan </span><em><span>node</span></em><span> lain dalam </span><em><span>cluster</span></em><span>.</span></p>
    <p><span>Kemudian, pada mesin yang ingin dijadikan </span><em><span>master node</span></em><span> lain, jalankan perintah berikut</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kubeadm join &lt;control_plane_ip&gt;:&lt;control_plane_port&gt; <span class="cm-attribute">--token</span> &lt;token&gt; <span class="cm-attribute">--discovery-token-ca-cert-hash</span> &lt;discovery_token_ca_cert_hash&gt; <span class="cm-attribute">--control-plane</span> <span class="cm-attribute">--certificate-key</span> &lt;certificate_key&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><figure><table><thead><tr><th><span>Parameter</span></th><th><span>Keterangan</span></th></tr></thead><tbody><tr><td><code>--token</code><span>, </span><code>--discovery-token-ca-cert-hash</code></td><td><span>parameter yang digunakan untuk mengidentifikasi </span><em><span>cluster</span></em><span> agar mesin tidak salah masuk </span><em><span>cluster</span></em><span>. Nilai dari kedua parameter ini bisa didapat dari keluaran teks hasil inisiasi </span><em><span>master node</span></em><span> yang pertama seperti pada teks di atas.</span></td></tr><tr><td><code>--control-plane</code></td><td><span>digunakan untuk menunjukkan bahwa mesin ini akan menjadi </span><em><span>master node</span></em><span>.</span></td></tr><tr><td><code>--certificate-key</code></td><td><span>digunakan untuk mesin yang akan menjadi </span><em><span>master node</span></em><span> untuk mendekripsi </span><strong><em><span>key</span></em></strong><span> dan </span><strong><em><span>certificate</span></em></strong><span> dari </span><em><span>master node</span></em><span> pertama. Nilai dari parameter ini bisa didapat dari keluaran teks hasil inisiasi </span><em><span>master node</span></em><span> yang pertama seperti pada teks di atas.</span></td></tr></tbody></table></figure><p><span>Sedangkan, pada mesin yang ingin dijadikan </span><em><span>worker node</span></em><span> tinggal jalankan perintah seperti di atas dengan menghapus parameter </span><code>--control-plane</code><span> dan </span><code>--certificate-key</code><span> seperti berikut</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kubeadm join &lt;control_plane_ip&gt;:&lt;control_plane_port&gt; <span class="cm-attribute">--token</span> &lt;token&gt; <span class="cm-attribute">--discovery-token-ca-cert-hash</span> &lt;discovery_token_ca_cert_hash&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><blockquote><p><span>Perlu diperhatikan bahwa </span><code>token</code><span> memiliki masa berlaku.</span></p></blockquote><p><span>Untuk membuat </span><code>token</code><span>, bisa dibuat dengan perintah berikut</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kubeadm create token <span class="cm-attribute">--print-join-command</span> <span class="cm-attribute">--ttl</span> &lt;ttl&gt; <span class="cm-attribute">--certificate-key</span> &lt;certificate_key&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><figure><table><thead><tr><th><span>Parameter</span></th><th><span>Keterangan</span></th></tr></thead><tbody><tr><td><code>--print-join-command</code></td><td><span>digunakan untuk mengeluarkan teks perintah untuk memasukkan mesin lain ke dalam </span><em><span>cluster</span></em><span> sebagai </span><em><span>worker node</span></em><span>. Jika parameter </span><code>--certificate-key</code><span> juga dimasukkan, maka teks perintah yang dikeluarkan untuk memasukkan mesin lain sebagai </span><em><span>master node</span></em><span>.</span></td></tr><tr><td><code>--ttl</code></td><td><span>digunakan untuk menentukan masa berlaku dari </span><code>token</code><span> yang dibuat (misal </span><code>1h</code><span>). Secara </span><em><span>default</span></em><span> adalah 24 jam (</span><code>24h0m0s</code><span>).</span></td></tr></tbody></table></figure><p><span>Untuk melihat daftar </span><code>token</code><span> yang telah dibuat, bisa gunakan perintah berikut</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kubeadm token list</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>dan untuk menghapus </span><code>token</code><span> yang telah dibuat, menggunakan perintah berikut</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kubeadm token delete &lt;token&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>Untuk </span><code>discovery_token_ca_cert_hash</code><span> dapat dibuat menggunakan perintah</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">openssl</span> x509 <span class="cm-attribute">-pubkey</span> <span class="cm-attribute">-in</span> /etc/kubernetes/pki/ca.crt | <span class="cm-builtin">openssl</span> rsa <span class="cm-attribute">-pubin</span> <span class="cm-attribute">-outform</span> der <span class="cm-number">2</span>&gt;/dev/null | <span class="cm-builtin">openssl</span> dgst <span class="cm-attribute">-sha256</span> <span class="cm-attribute">-hex</span> | <span class="cm-builtin">sed</span> <span class="cm-string">'s/^.* /sha256:/'</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><blockquote><p><code>discovery_token_ca_cert_hash</code><span> juga otomatis dibuatkan saat membuat </span><code>token</code><span> dengan parameter </span><code>--print-join-command</code><span>.</span></p></blockquote><p><span>Jika </span><code>certificate_key</code><span> yang dibuat sudah habis masa berlakunya (setelah 2 jam secara </span><em><span>default</span></em><span>) dan kita ingin menambah mesin baru sebagai </span><em><span>master node</span></em><span>, </span><code>certificate_key</code><span> dapat dibuat ulang dengan perintah di dalam mesin yang sudah menjadi </span><em><span>master node</span></em></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">kubeadm init phase upload-certs <span class="cm-attribute">--upload-certs</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><blockquote><p><code>certificate_key</code><span> bersifat rahasia dan jangan disebarkan!</span></p></blockquote><p><span>Terakhir, jalankan perintah berikut di </span><em><span>master node</span></em><span> untuk memeriksa apakah semua mesin sudah masuk </span><em><span>cluster</span></em></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">watch <span class="cm-attribute">-n</span> <span class="cm-number">1</span> kubectl <span class="cm-builtin">get</span> nodes</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><span>dan tunggu sampai semua </span><strong><span>STATUS Ready</span></strong></p>
</div>